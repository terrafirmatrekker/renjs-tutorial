(this["webpackJsonprenjs-tutorial"]=this["webpackJsonprenjs-tutorial"]||[]).push([[0],{1086:function(t,e,n){},1089:function(t,e,n){"use strict";n.r(e);var a=n(50),r=n.n(a),o=n(456),s=n.n(o),c=(n(464),n(458)),i=n(11),u=n.n(i),l=n(113),p=n(65),m=n(98),d=n(97),f=n(99),b=n(114),y=n.n(b),g=n(457),w=n.n(g),h=(n(1086),n(293)),T="0xb2731C04610C10f2eB6A26ad14E607d44309FC10",x=function(t){function e(t){var n;return Object(p.a)(this,e),(n=Object(m.a)(this,Object(d.a)(e).call(this,t))).componentDidMount=Object(l.a)(u.a.mark((function t(){var e,a,r;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!window.ethereum){t.next=13;break}return e=window.ethereum,t.prev=2,t.next=5,window.ethereum.enable();case 5:t.next=11;break;case 7:return t.prev=7,t.t0=t.catch(2),n.logError("Please allow access to your Web3 wallet."),t.abrupt("return");case 11:t.next=19;break;case 13:if(!window.web3){t.next=17;break}e=window.web3.currentProvider,t.next=19;break;case 17:return n.logError("Please install MetaMask!"),t.abrupt("return");case 19:return a=new w.a(e),t.next=22,a.eth.net.getId();case 22:if(42===t.sent){t.next=26;break}return n.logError("Please set your network to Kovan."),t.abrupt("return");case 26:n.setState({web3:a},(function(){n.updateBalance(),setInterval((function(){n.updateBalance()}),1e4)})),(r=n.getTrade())&&r.sendToken===y.a.Tokens.BTC.Btc2Eth&&n.deposit(r),r&&r.sendToken===y.a.Tokens.BTC.Eth2Btc&&n.withdraw(r);case 30:case"end":return t.stop()}}),t,null,[[2,7]])}))),n.render=function(){var t=n.state,e=t.balance,a=t.message,o=t.error;return r.a.createElement("div",{className:"App"},r.a.createElement("p",null,"Balance: ",e," BTC"),r.a.createElement("p",null,r.a.createElement("button",{onClick:function(){return n.deposit().catch(n.logError)}},"Deposit 0.001 BTC")),r.a.createElement("p",null,r.a.createElement("button",{onClick:function(){return n.withdraw().catch(n.logError)}},"Withdraw ",e," BTC")),r.a.createElement("p",null,a),o?r.a.createElement("p",{style:{color:"red"}},o):null)},n.updateBalance=Object(l.a)(u.a.mark((function t(){var e,a,r;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=n.state.web3,a=new e.eth.Contract(h,T),t.next=4,a.methods.balance().call();case 4:r=t.sent,n.setState({balance:parseInt(r.toString())/Math.pow(10,8)});case 6:case"end":return t.stop()}}),t)}))),n.logError=function(t){t&&console.error(t),n.setState({error:String((t||{}).message||t)})},n.log=function(t){n.setState({message:t})},n.storeTrade=function(t){localStorage.setItem("trade",JSON.stringify(t))},n.getTrade=function(){try{return JSON.parse(localStorage.getItem("trade"))}catch(t){return}},n.deposit=function(){var t=Object(l.a)(u.a.mark((function t(e){var a,r,o,s,c,i,l,p;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.logError(""),a=n.state,r=a.web3,o=a.renJS,s=.001,e=e||{sendToken:y.a.Tokens.BTC.Btc2Eth,suggestedAmount:Math.floor(s*Math.pow(10,8)),sendTo:T,contractFn:"deposit",nonce:o.utils.randomNonce(),contractParams:[{name:"_msg",type:"bytes",value:r.utils.fromAscii("Depositing ".concat(s," BTC"))}]},n.storeTrade(e),c=o.shiftIn(e),i=c.addr(),n.log("Deposit ".concat(s," BTC to ").concat(i)),2,t.next=11,c.waitForDeposit(2).on("deposit",(function(t){return n.log("Waiting for BTC confirmations: ".concat(t.utxo.confirmations,"/").concat(2))}));case 11:return l=t.sent,n.log("Submitting to RenVM..."),t.next=15,l.submitToRenVM().on("status",(function(t){return n.log("Submitting to RenVM... (".concat(t,")"))}));case 15:return p=t.sent,n.log("Submitting to smart contract..."),t.next=19,p.submitToEthereum(r.currentProvider).on("transactionHash",(function(t){return n.log("Submitting to smart contract... (hash: ".concat(t,")"))}));case 19:n.log("Deposited ".concat(s," BTC.")),n.storeTrade(void 0);case 21:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),n.withdraw=function(){var t=Object(l.a)(u.a.mark((function t(e){var a,r,o,s,i,l,p,m,d,f;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n.logError(""),a=n.state,r=a.web3,o=a.renJS,s=a.balance,e){t.next=15;break}return i=s,l=prompt("Enter BTC recipient:"),t.next=7,r.eth.getAccounts();case 7:return p=t.sent[0],m=new r.eth.Contract(h,T),n.log("Calling `withdraw` on smart contract..."),t.next=12,new Promise((function(t,e){m.methods.withdraw(r.utils.fromAscii("Depositing ".concat(i," BTC")),y.a.utils.btc.addressToHex(l),Math.floor(i*Math.pow(10,8))).send({from:p}).on("transactionHash",t).catch(e)}));case 12:d=t.sent,e={sendToken:y.a.Tokens.BTC.Eth2Btc,txHash:d},n.storeTrade(e);case 15:return n.log("Retrieving burn event from contract..."),t.next=18,o.shiftOut(Object(c.a)({},e,{web3Provider:r.currentProvider})).readFromEthereum();case 18:return f=t.sent,n.log("Submitting to RenVM..."),t.next=22,f.submitToRenVM().on("status",(function(t){return n.log("Submitting to RenVM... (".concat(t,")"))}));case 22:n.log("Withdrew BTC successfully."),n.storeTrade(void 0);case 24:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),n.state={balance:0,message:"",error:"",renJS:new y.a("testnet")},n}return Object(f.a)(e,t),e}(r.a.Component);s.a.render(r.a.createElement(x,null),document.getElementById("root"))},293:function(t){t.exports=JSON.parse('[{"constant":false,"inputs":[{"name":"_msg","type":"bytes"},{"name":"_amount","type":"uint256"},{"name":"_nHash","type":"bytes32"},{"name":"_sig","type":"bytes"}],"name":"deposit","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"_msg","type":"bytes"},{"name":"_to","type":"bytes"},{"name":"_amount","type":"uint256"}],"name":"withdraw","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[],"name":"registry","outputs":[{"name":"","type":"address"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"balance","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"inputs":[{"name":"_registry","type":"address"}],"payable":false,"stateMutability":"nonpayable","type":"constructor"},{"anonymous":false,"inputs":[{"indexed":false,"name":"_amount","type":"uint256"},{"indexed":false,"name":"_msg","type":"bytes"}],"name":"Deposit","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"name":"_to","type":"bytes"},{"indexed":false,"name":"_amount","type":"uint256"},{"indexed":false,"name":"_msg","type":"bytes"}],"name":"Withdraw","type":"event"}]')},459:function(t,e,n){t.exports=n(1089)},464:function(t,e,n){},482:function(t,e){},484:function(t,e){},577:function(t,e){},615:function(t,e){},618:function(t,e){},648:function(t,e){},764:function(t,e){},766:function(t,e){}},[[459,1,2]]]);
//# sourceMappingURL=main.61007588.chunk.js.map