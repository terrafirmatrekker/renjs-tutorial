(this["webpackJsonprenjs-tutorial"]=this["webpackJsonprenjs-tutorial"]||[]).push([[0],{1096:function(e,t,n){},1098:function(e,t,n){"use strict";n.r(t);var a=n(47),r=n.n(a),o=n(449),s=n.n(o),c=(n(461),n(454)),i=n(7),u=n.n(i),l=n(450),p=n(453),m=n(451),d=n(455),f=n(109),b=n.n(f),w=n(452),y=n.n(w),g=(n(1096),n(287)),h="0xb2731C04610C10f2eB6A26ad14E607d44309FC10",T=function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(p.a)(this,Object(m.a)(t).call(this,e))).componentDidMount=function(){var e,t,a;return u.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:if(!window.ethereum){r.next=13;break}return e=window.ethereum,r.prev=2,r.next=5,u.a.awrap(window.ethereum.enable());case 5:r.next=11;break;case 7:return r.prev=7,r.t0=r.catch(2),n.logError("Please allow access to your Web3 wallet."),r.abrupt("return");case 11:r.next=19;break;case 13:if(!window.web3){r.next=17;break}e=window.web3.currentProvider,r.next=19;break;case 17:return n.logError("Please install MetaMask!"),r.abrupt("return");case 19:return t=new y.a(e),r.next=22,u.a.awrap(t.eth.net.getId());case 22:if(42===r.sent){r.next=26;break}return n.logError("Please set your network to Kovan."),r.abrupt("return");case 26:n.setState({web3:t},(function(){n.updateBalance(),setInterval((function(){n.updateBalance()}),1e4)})),(a=n.getTrade())&&a.sendToken===b.a.Tokens.BTC.Btc2Eth&&n.deposit(a),a&&a.sendToken===b.a.Tokens.BTC.Eth2Btc&&n.withdraw(a);case 30:case"end":return r.stop()}}),null,null,[[2,7]])},n.render=function(){var e=n.state,t=e.balance,a=e.message,o=e.error;return r.a.createElement("div",{className:"App"},r.a.createElement("p",null,"Balance: ",t," BTC"),r.a.createElement("p",null,r.a.createElement("button",{onClick:function(){return n.deposit().catch(n.logError)}},"Deposit 0.001 BTC")),r.a.createElement("p",null,r.a.createElement("button",{onClick:function(){return n.withdraw().catch(n.logError)}},"Withdraw ",t," BTC")),r.a.createElement("p",null,a),o?r.a.createElement("p",{style:{color:"red"}},o):null)},n.updateBalance=function(){var e,t,a;return u.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return e=n.state.web3,t=new e.eth.Contract(g,h),r.next=4,u.a.awrap(t.methods.balance().call());case 4:a=r.sent,n.setState({balance:parseInt(a.toString())/Math.pow(10,8)});case 6:case"end":return r.stop()}}))},n.logError=function(e){e&&console.error(e),n.setState({error:String((e||{}).message||e)})},n.log=function(e){n.setState({message:e})},n.storeTrade=function(e){localStorage.setItem("trade",JSON.stringify(e))},n.getTrade=function(){try{return JSON.parse(localStorage.getItem("trade"))}catch(e){return}},n.deposit=function(e){var t,a,r,o,s,c,i,l;return u.a.async((function(p){for(;;)switch(p.prev=p.next){case 0:return n.logError(""),t=n.state,a=t.web3,r=t.renJS,o=.001,e=e||{sendToken:b.a.Tokens.BTC.Btc2Eth,sendAmount:Math.floor(o*Math.pow(10,8)),sendTo:h,contractFn:"deposit",nonce:r.utils.randomNonce(),contractParams:[{name:"_msg",type:"bytes",value:a.utils.fromAscii("Depositing ".concat(o," BTC"))}]},n.storeTrade(e),s=r.shiftIn(e),c=s.addr(),n.log("Deposit ".concat(o," BTC to ").concat(c)),2,p.next=11,u.a.awrap(s.waitForDeposit(2).on("deposit",(function(e){return n.log("Waiting for BTC confirmations: ".concat(e.utxo.confirmations,"/").concat(2))})));case 11:return i=p.sent,n.log("Submitting to RenVM..."),p.next=15,u.a.awrap(i.submitToRenVM().on("status",(function(e){return n.log("Submitting to RenVM... (".concat(e,")"))})));case 15:return l=p.sent,n.log("Submitting to smart contract..."),p.next=19,u.a.awrap(l.submitToEthereum(a.currentProvider).on("transactionHash",(function(e){return n.log("Submitting to smart contract... (hash: ".concat(e,")"))})));case 19:n.log("Deposited ".concat(o," BTC.")),n.storeTrade(void 0);case 21:case"end":return p.stop()}}))},n.withdraw=function(e){var t,a,r,o,s,i,l,p,m,d;return u.a.async((function(f){for(;;)switch(f.prev=f.next){case 0:if(n.logError(""),t=n.state,a=t.web3,r=t.renJS,o=t.balance,e){f.next=15;break}return s=o,i=prompt("Enter BTC recipient:"),f.next=7,u.a.awrap(a.eth.getAccounts());case 7:return l=f.sent[0],p=new a.eth.Contract(g,h),n.log("Calling `withdraw` on smart contract..."),f.next=12,u.a.awrap(new Promise((function(e,t){p.methods.withdraw(a.utils.fromAscii("Depositing ".concat(s," BTC")),b.a.utils.btc.addressToHex(i),Math.floor(s*Math.pow(10,8))).send({from:l}).on("transactionHash",e).catch(t)})));case 12:m=f.sent,e={sendToken:b.a.Tokens.BTC.Eth2Btc,txHash:m},n.storeTrade(e);case 15:return n.log("Retrieving burn event from contract..."),f.next=18,u.a.awrap(r.shiftOut(Object(c.a)({},e,{web3Provider:a.currentProvider})).readFromEthereum());case 18:return d=f.sent,n.log("Submitting to RenVM..."),f.next=22,u.a.awrap(d.submitToRenVM().on("status",(function(e){return n.log("Submitting to RenVM... (".concat(e,")"))})));case 22:n.log("Withdrew BTC successfully."),n.storeTrade(void 0);case 24:case"end":return f.stop()}}))},n.state={balance:0,message:"",error:"",renJS:new b.a("testnet")},n}return Object(d.a)(t,e),t}(r.a.Component);s.a.render(r.a.createElement(T,null),document.getElementById("root"))},287:function(e){e.exports=JSON.parse('[{"constant":false,"inputs":[{"name":"_msg","type":"bytes"},{"name":"_amount","type":"uint256"},{"name":"_nHash","type":"bytes32"},{"name":"_sig","type":"bytes"}],"name":"deposit","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"_msg","type":"bytes"},{"name":"_to","type":"bytes"},{"name":"_amount","type":"uint256"}],"name":"withdraw","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[],"name":"registry","outputs":[{"name":"","type":"address"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"balance","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"inputs":[{"name":"_registry","type":"address"}],"payable":false,"stateMutability":"nonpayable","type":"constructor"},{"anonymous":false,"inputs":[{"indexed":false,"name":"_amount","type":"uint256"},{"indexed":false,"name":"_msg","type":"bytes"}],"name":"Deposit","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"name":"_to","type":"bytes"},{"indexed":false,"name":"_amount","type":"uint256"},{"indexed":false,"name":"_msg","type":"bytes"}],"name":"Withdraw","type":"event"}]')},456:function(e,t,n){e.exports=n(1098)},461:function(e,t,n){},473:function(e,t){},480:function(e,t){},499:function(e,t){},501:function(e,t){},583:function(e,t){},716:function(e,t){},759:function(e,t){}},[[456,1,2]]]);
//# sourceMappingURL=main.a470c4b8.chunk.js.map