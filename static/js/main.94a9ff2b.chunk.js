(this["webpackJsonprenjs-tutorial"]=this["webpackJsonprenjs-tutorial"]||[]).push([[0],{1084:function(t,e,n){},1087:function(t,e,n){"use strict";n.r(e);var a=n(49),r=n.n(a),o=n(454),s=n.n(o),c=(n(462),n(456)),i=n(6),u=n.n(i),l=n(64),p=n(97),m=n(96),d=n(98),f=n(112),b=n.n(f),w=n(455),y=n.n(w),g=(n(1084),n(291)),h="0xb2731C04610C10f2eB6A26ad14E607d44309FC10",T=function(t){function e(t){var n;return Object(l.a)(this,e),(n=Object(p.a)(this,Object(m.a)(e).call(this,t))).componentDidMount=function(){var t,e,a;return u.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:if(!window.ethereum){r.next=13;break}return t=window.ethereum,r.prev=2,r.next=5,u.a.awrap(window.ethereum.enable());case 5:r.next=11;break;case 7:return r.prev=7,r.t0=r.catch(2),n.logError("Please allow access to your Web3 wallet."),r.abrupt("return");case 11:r.next=19;break;case 13:if(!window.web3){r.next=17;break}t=window.web3.currentProvider,r.next=19;break;case 17:return n.logError("Please install MetaMask!"),r.abrupt("return");case 19:return e=new y.a(t),r.next=22,u.a.awrap(e.eth.net.getId());case 22:if(42===r.sent){r.next=26;break}return n.logError("Please set your network to Kovan."),r.abrupt("return");case 26:n.setState({web3:e},(function(){n.updateBalance(),setInterval((function(){n.updateBalance()}),1e4)})),(a=n.getTrade())&&a.sendToken===b.a.Tokens.BTC.Btc2Eth&&n.deposit(a),a&&a.sendToken===b.a.Tokens.BTC.Eth2Btc&&n.withdraw(a);case 30:case"end":return r.stop()}}),null,null,[[2,7]])},n.render=function(){var t=n.state,e=t.balance,a=t.message,o=t.error;return r.a.createElement("div",{className:"App"},r.a.createElement("p",null,"Balance: ",e," BTC"),r.a.createElement("p",null,r.a.createElement("button",{onClick:function(){return n.deposit().catch(n.logError)}},"Deposit 0.001 BTC")),r.a.createElement("p",null,r.a.createElement("button",{onClick:function(){return n.withdraw().catch(n.logError)}},"Withdraw ",e," BTC")),r.a.createElement("p",null,a),o?r.a.createElement("p",{style:{color:"red"}},o):null)},n.updateBalance=function(){var t,e,a;return u.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return t=n.state.web3,e=new t.eth.Contract(g,h),r.next=4,u.a.awrap(e.methods.balance().call());case 4:a=r.sent,n.setState({balance:parseInt(a.toString())/Math.pow(10,8)});case 6:case"end":return r.stop()}}))},n.logError=function(t){t&&console.error(t),n.setState({error:String((t||{}).message||t)})},n.log=function(t){n.setState({message:t})},n.storeTrade=function(t){localStorage.setItem("trade",JSON.stringify(t))},n.getTrade=function(){try{return JSON.parse(localStorage.getItem("trade"))}catch(t){return}},n.deposit=function(t){var e,a,r,o,s,c,i,l;return u.a.async((function(p){for(;;)switch(p.prev=p.next){case 0:return n.logError(""),e=n.state,a=e.web3,r=e.renJS,o=.001,t=t||{sendToken:b.a.Tokens.BTC.Btc2Eth,suggestedAmount:Math.floor(o*Math.pow(10,8)),sendTo:h,contractFn:"deposit",nonce:r.utils.randomNonce(),contractParams:[{name:"_msg",type:"bytes",value:a.utils.fromAscii("Depositing ".concat(o," BTC"))}]},n.storeTrade(t),s=r.shiftIn(t),c=s.addr(),n.log("Deposit ".concat(o," BTC to ").concat(c)),2,p.next=11,u.a.awrap(s.waitForDeposit(2).on("deposit",(function(t){return n.log("Waiting for BTC confirmations: ".concat(t.utxo.confirmations,"/").concat(2))})));case 11:return i=p.sent,n.log("Submitting to RenVM..."),p.next=15,u.a.awrap(i.submitToRenVM().on("status",(function(t){return n.log("Submitting to RenVM... (".concat(t,")"))})));case 15:return l=p.sent,n.log("Submitting to smart contract..."),p.next=19,u.a.awrap(l.submitToEthereum(a.currentProvider).on("transactionHash",(function(t){return n.log("Submitting to smart contract... (hash: ".concat(t,")"))})));case 19:n.log("Deposited ".concat(o," BTC.")),n.storeTrade(void 0);case 21:case"end":return p.stop()}}))},n.withdraw=function(t){var e,a,r,o,s,i,l,p,m,d;return u.a.async((function(f){for(;;)switch(f.prev=f.next){case 0:if(n.logError(""),e=n.state,a=e.web3,r=e.renJS,o=e.balance,t){f.next=15;break}return s=o,i=prompt("Enter BTC recipient:"),f.next=7,u.a.awrap(a.eth.getAccounts());case 7:return l=f.sent[0],p=new a.eth.Contract(g,h),n.log("Calling `withdraw` on smart contract..."),f.next=12,u.a.awrap(new Promise((function(t,e){p.methods.withdraw(a.utils.fromAscii("Depositing ".concat(s," BTC")),b.a.utils.btc.addressToHex(i),Math.floor(s*Math.pow(10,8))).send({from:l}).on("transactionHash",t).catch(e)})));case 12:m=f.sent,t={sendToken:b.a.Tokens.BTC.Eth2Btc,txHash:m},n.storeTrade(t);case 15:return n.log("Retrieving burn event from contract..."),f.next=18,u.a.awrap(r.shiftOut(Object(c.a)({},t,{web3Provider:a.currentProvider})).readFromEthereum());case 18:return d=f.sent,n.log("Submitting to RenVM..."),f.next=22,u.a.awrap(d.submitToRenVM().on("status",(function(t){return n.log("Submitting to RenVM... (".concat(t,")"))})));case 22:n.log("Withdrew BTC successfully."),n.storeTrade(void 0);case 24:case"end":return f.stop()}}))},n.state={balance:0,message:"",error:"",renJS:new b.a("testnet")},n}return Object(d.a)(e,t),e}(r.a.Component);s.a.render(r.a.createElement(T,null),document.getElementById("root"))},291:function(t){t.exports=JSON.parse('[{"constant":false,"inputs":[{"name":"_msg","type":"bytes"},{"name":"_amount","type":"uint256"},{"name":"_nHash","type":"bytes32"},{"name":"_sig","type":"bytes"}],"name":"deposit","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"_msg","type":"bytes"},{"name":"_to","type":"bytes"},{"name":"_amount","type":"uint256"}],"name":"withdraw","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[],"name":"registry","outputs":[{"name":"","type":"address"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"balance","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"inputs":[{"name":"_registry","type":"address"}],"payable":false,"stateMutability":"nonpayable","type":"constructor"},{"anonymous":false,"inputs":[{"indexed":false,"name":"_amount","type":"uint256"},{"indexed":false,"name":"_msg","type":"bytes"}],"name":"Deposit","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"name":"_to","type":"bytes"},{"indexed":false,"name":"_amount","type":"uint256"},{"indexed":false,"name":"_msg","type":"bytes"}],"name":"Withdraw","type":"event"}]')},457:function(t,e,n){t.exports=n(1087)},462:function(t,e,n){},480:function(t,e){},482:function(t,e){},575:function(t,e){},613:function(t,e){},616:function(t,e){},646:function(t,e){},762:function(t,e){},764:function(t,e){}},[[457,1,2]]]);
//# sourceMappingURL=main.94a9ff2b.chunk.js.map